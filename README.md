# Hybrid Cellular Automaton Model for the within-host study of SARS-CoV-2 infection

This repository contains the computational implementation of the model communicated in our manuscript ["*Modelling the within-host spread of SARS-CoV-2 infection, and the subsequent immune response, using a hybrid, multiscale, individual-based model. Part I: Macrophages*" [1]]().

## Caveats and disclaimers
A newer version of this code, which is more user and developer friendly, is currently being developed. Therefore, this repository will likely become deprecated in the future. Furthermore, the code is intended **solely** for research purposes, and cannot be used in **any** other way.

## Compilation

### Pre-requisites

The compilation of the code requires [GNU Make](https://www.gnu.org/software/make/). Furthermore, the code has hard dependencies on [YAML-cpp](https://github.com/jbeder/yaml-cpp) and the [GNU Scientific Library](https://www.gnu.org/software/gsl/), which will need to be installed prior to compilation.

### Linux and MacOS X

To compile the code, simply issue the following command in a terminal:

* `make clean && make`

Debug and profile targets are also available in the `Makefile`:

* `make clean && make debug`
* `make clean && make profile`

## Usage

### Linux and MacOS X

To run the code, simply enter the following command in a terminal:

* `./camodel.exe <YAML Input File> <Output Directory>`

where `<YAML Input File>` denotes the path to the YAML input file (examples of which can be found in the data repository [[2]]() for our manuscript [[1]]()) and `<Output Directory>` denotes the directory where the simulation output is to be placed.

## Visualisation

To plot the output generated by the code, we recommend using the Python plotting scripts available in the data repository [[2]]() for our manuscript [[1]](). Note that the plotting scripts have dependencies on the Python packages: `tarfile`, `multiprocessing`, `numpy`, `scipy`, and `matplotlib`.

## References

[1] C. F. Rowlatt, M. A. J. Chaplain, D. J. Hughes, S. H. Gillespie, D. H. Dockrell, I. Johannessen, and R. Bowness. Modelling the within-host spread of SARS-CoV-2 infection, and the subsequent immune response, using a hybrid, multiscale, individual-based model. Part I: Macrophages. preprint, bioRxiv, 2022. DOI:

[2] C. F. Rowlatt, M. A. J. Chaplain, D. J. Hughes, S. H. Gillespie, D. H. Dockrell, I. Johannessen, and R. Bowness. Modelling the within-host spread of SARS-CoV-2 infection, and the subsequent immune response, using a hybrid, multiscale, individual-based model. Part I: Macrophages. Zenodo data repository, 2022. DOI: [10.5281/zenodo.6514656](https://doi.org/10.5281/zenodo.6514656).
